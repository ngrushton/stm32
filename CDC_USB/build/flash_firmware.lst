ARM GAS  /var/folders/k_/d4dbklhx7q1fs9lh20k9kt840000gn/T//ccA01qef.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"flash_firmware.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.Save_Rec_FW,"ax",%progbits
  18              		.align	1
  19              		.global	Save_Rec_FW
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	Save_Rec_FW:
  26              	.LFB133:
  27              		.file 1 "Src/flash_firmware.c"
   1:Src/flash_firmware.c **** #include "flash_firmware.h"
   2:Src/flash_firmware.c **** #include "usbd_cdc_if.h"
   3:Src/flash_firmware.c **** 
   4:Src/flash_firmware.c **** HAL_StatusTypeDef Save_Rec_FW(char *data_to_flash, uint32_t len) {
  28              		.loc 1 4 0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 96
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              	.LVL0:
  33 0000 F0B5     		push	{r4, r5, r6, r7, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 20
  36              		.cfi_offset 4, -20
  37              		.cfi_offset 5, -16
  38              		.cfi_offset 6, -12
  39              		.cfi_offset 7, -8
  40              		.cfi_offset 14, -4
  41 0002 99B0     		sub	sp, sp, #100
  42              	.LCFI1:
  43              		.cfi_def_cfa_offset 120
  44 0004 0746     		mov	r7, r0
  45 0006 0E46     		mov	r6, r1
   5:Src/flash_firmware.c **** 
   6:Src/flash_firmware.c ****     volatile HAL_StatusTypeDef flashStatus = HAL_OK;
  46              		.loc 1 6 0
  47 0008 0023     		movs	r3, #0
  48 000a 8DF85F30 		strb	r3, [sp, #95]
   7:Src/flash_firmware.c **** 
   8:Src/flash_firmware.c ****     FLASH_EraseInitTypeDef EraseInitStruct;
   9:Src/flash_firmware.c ****     EraseInitStruct.TypeErase   = FLASH_TYPEERASE_PAGES;
  49              		.loc 1 9 0
ARM GAS  /var/folders/k_/d4dbklhx7q1fs9lh20k9kt840000gn/T//ccA01qef.s 			page 2


  50 000e 1393     		str	r3, [sp, #76]
  10:Src/flash_firmware.c ****     EraseInitStruct.Banks       = FLASH_BANK_2;
  51              		.loc 1 10 0
  52 0010 0222     		movs	r2, #2
  53 0012 1492     		str	r2, [sp, #80]
  11:Src/flash_firmware.c ****     EraseInitStruct.Page        = 0;
  54              		.loc 1 11 0
  55 0014 1593     		str	r3, [sp, #84]
  12:Src/flash_firmware.c ****     EraseInitStruct.NbPages     = 240;
  56              		.loc 1 12 0
  57 0016 F023     		movs	r3, #240
  58 0018 1693     		str	r3, [sp, #88]
  13:Src/flash_firmware.c **** 
  14:Src/flash_firmware.c ****     /* Unlock the Flash to enable the flash control register access *************/
  15:Src/flash_firmware.c ****     HAL_FLASH_Unlock();
  59              		.loc 1 15 0
  60 001a FFF7FEFF 		bl	HAL_FLASH_Unlock
  61              	.LVL1:
  16:Src/flash_firmware.c **** 
  17:Src/flash_firmware.c ****     if (firstPackage) {
  62              		.loc 1 17 0
  63 001e 2E4B     		ldr	r3, .L10
  64 0020 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  65 0022 5BB9     		cbnz	r3, .L9
  66              	.L2:
  18:Src/flash_firmware.c ****         uint32_t PageError;
  19:Src/flash_firmware.c ****         flashStatus = HAL_FLASHEx_Erase(&EraseInitStruct, &PageError);
  20:Src/flash_firmware.c ****         HAL_UART_Transmit(&huart2, (uint8_t*)"Erased\r\n", 8, 100);
  21:Src/flash_firmware.c ****         firstPackage = 0;
  22:Src/flash_firmware.c ****     }
  23:Src/flash_firmware.c **** 
  24:Src/flash_firmware.c ****     char chunk[8];
  25:Src/flash_firmware.c ****     char sendString[64];
  26:Src/flash_firmware.c **** 
  27:Src/flash_firmware.c ****     HAL_UART_Transmit(&huart2, (uint8_t*)"Flashing\r\n", 10, 100);
  67              		.loc 1 27 0
  68 0024 6423     		movs	r3, #100
  69 0026 0A22     		movs	r2, #10
  70 0028 2C49     		ldr	r1, .L10+4
  71 002a 2D48     		ldr	r0, .L10+8
  72 002c FFF7FEFF 		bl	HAL_UART_Transmit
  73              	.LVL2:
  28:Src/flash_firmware.c **** 
  29:Src/flash_firmware.c ****     if (flashStatus == HAL_OK) {
  74              		.loc 1 29 0
  75 0030 9DF85F30 		ldrb	r3, [sp, #95]	@ zero_extendqisi2
  76 0034 002B     		cmp	r3, #0
  77 0036 43D1     		bne	.L4
  78              	.LBB2:
  30:Src/flash_firmware.c ****         for (int i = 0; i < (int)(len/8); i++) {
  79              		.loc 1 30 0
  80 0038 0024     		movs	r4, #0
  81 003a 10E0     		b	.L3
  82              	.L9:
  83              	.LBE2:
  84              	.LBB3:
  19:Src/flash_firmware.c ****         HAL_UART_Transmit(&huart2, (uint8_t*)"Erased\r\n", 8, 100);
ARM GAS  /var/folders/k_/d4dbklhx7q1fs9lh20k9kt840000gn/T//ccA01qef.s 			page 3


  85              		.loc 1 19 0
  86 003c 6946     		mov	r1, sp
  87 003e 13A8     		add	r0, sp, #76
  88 0040 FFF7FEFF 		bl	HAL_FLASHEx_Erase
  89              	.LVL3:
  90 0044 8DF85F00 		strb	r0, [sp, #95]
  20:Src/flash_firmware.c ****         firstPackage = 0;
  91              		.loc 1 20 0
  92 0048 6423     		movs	r3, #100
  93 004a 0822     		movs	r2, #8
  94 004c 2549     		ldr	r1, .L10+12
  95 004e 2448     		ldr	r0, .L10+8
  96 0050 FFF7FEFF 		bl	HAL_UART_Transmit
  97              	.LVL4:
  21:Src/flash_firmware.c ****     }
  98              		.loc 1 21 0
  99 0054 204B     		ldr	r3, .L10
 100 0056 0022     		movs	r2, #0
 101 0058 1A70     		strb	r2, [r3]
 102 005a E3E7     		b	.L2
 103              	.LVL5:
 104              	.L5:
 105              	.LBE3:
 106              	.LBB4:
 107              		.loc 1 30 0 discriminator 2
 108 005c 0134     		adds	r4, r4, #1
 109              	.LVL6:
 110              	.L3:
 111              		.loc 1 30 0 is_stmt 0 discriminator 1
 112 005e B4EBD60F 		cmp	r4, r6, lsr #3
 113 0062 2DDA     		bge	.L4
  31:Src/flash_firmware.c ****             // sprintf(sendString, "Add: %ld\r\n", flashAddress);
  32:Src/flash_firmware.c ****             HAL_UART_Transmit(&huart2, (uint8_t*)sendString, 15, 100);
 114              		.loc 1 32 0 is_stmt 1
 115 0064 1E4D     		ldr	r5, .L10+8
 116 0066 6423     		movs	r3, #100
 117 0068 0F22     		movs	r2, #15
 118 006a 01A9     		add	r1, sp, #4
 119 006c 2846     		mov	r0, r5
 120 006e FFF7FEFF 		bl	HAL_UART_Transmit
 121              	.LVL7:
  33:Src/flash_firmware.c ****             memcpy(chunk, data_to_flash+(i*8), 8);
 122              		.loc 1 33 0
 123 0072 07EBC402 		add	r2, r7, r4, lsl #3
 124 0076 11AB     		add	r3, sp, #68
 125 0078 1068     		ldr	r0, [r2]	@ unaligned
 126 007a 5168     		ldr	r1, [r2, #4]	@ unaligned
 127 007c 03C3     		stmia	r3!, {r0, r1}
  34:Src/flash_firmware.c ****             flashStatus = HAL_FLASH_Program(FLASH_TYPEPROGRAM_DOUBLEWORD, flashAddress, *(uint64_t*
 128              		.loc 1 34 0
 129 007e 0246     		mov	r2, r0
 130 0080 129B     		ldr	r3, [sp, #72]
 131 0082 1949     		ldr	r1, .L10+16
 132 0084 0968     		ldr	r1, [r1]
 133 0086 0020     		movs	r0, #0
 134 0088 FFF7FEFF 		bl	HAL_FLASH_Program
 135              	.LVL8:
ARM GAS  /var/folders/k_/d4dbklhx7q1fs9lh20k9kt840000gn/T//ccA01qef.s 			page 4


 136 008c 8DF85F00 		strb	r0, [sp, #95]
  35:Src/flash_firmware.c ****             HAL_UART_Transmit(&huart2, (uint8_t*)chunk, 8, 100);
 137              		.loc 1 35 0
 138 0090 6423     		movs	r3, #100
 139 0092 0822     		movs	r2, #8
 140 0094 11A9     		add	r1, sp, #68
 141 0096 2846     		mov	r0, r5
 142 0098 FFF7FEFF 		bl	HAL_UART_Transmit
 143              	.LVL9:
  36:Src/flash_firmware.c ****             HAL_UART_Transmit(&huart2, (uint8_t*)" ", 1, 100);
 144              		.loc 1 36 0
 145 009c 6423     		movs	r3, #100
 146 009e 0122     		movs	r2, #1
 147 00a0 1249     		ldr	r1, .L10+20
 148 00a2 2846     		mov	r0, r5
 149 00a4 FFF7FEFF 		bl	HAL_UART_Transmit
 150              	.LVL10:
  37:Src/flash_firmware.c ****             if (flashStatus != HAL_OK) {
 151              		.loc 1 37 0
 152 00a8 9DF85F30 		ldrb	r3, [sp, #95]	@ zero_extendqisi2
 153 00ac 43B9     		cbnz	r3, .L4
  38:Src/flash_firmware.c ****                 break;
  39:Src/flash_firmware.c ****             }
  40:Src/flash_firmware.c ****             else if (flashStatus == HAL_OK) {
 154              		.loc 1 40 0
 155 00ae 9DF85F30 		ldrb	r3, [sp, #95]	@ zero_extendqisi2
 156 00b2 002B     		cmp	r3, #0
 157 00b4 D2D1     		bne	.L5
  41:Src/flash_firmware.c ****                 flashAddress += 8;
 158              		.loc 1 41 0
 159 00b6 0C4A     		ldr	r2, .L10+16
 160 00b8 1368     		ldr	r3, [r2]
 161 00ba 0833     		adds	r3, r3, #8
 162 00bc 1360     		str	r3, [r2]
 163 00be CDE7     		b	.L5
 164              	.LVL11:
 165              	.L4:
 166              	.LBE4:
  42:Src/flash_firmware.c ****             }
  43:Src/flash_firmware.c ****         }
  44:Src/flash_firmware.c ****     }
  45:Src/flash_firmware.c ****     HAL_FLASH_Lock();
 167              		.loc 1 45 0
 168 00c0 FFF7FEFF 		bl	HAL_FLASH_Lock
 169              	.LVL12:
  46:Src/flash_firmware.c **** 
  47:Src/flash_firmware.c ****     HAL_UART_Transmit(&huart2, (uint8_t*)"\n", 1, 100);
 170              		.loc 1 47 0
 171 00c4 6423     		movs	r3, #100
 172 00c6 0122     		movs	r2, #1
 173 00c8 0949     		ldr	r1, .L10+24
 174 00ca 0548     		ldr	r0, .L10+8
 175 00cc FFF7FEFF 		bl	HAL_UART_Transmit
 176              	.LVL13:
  48:Src/flash_firmware.c **** 
  49:Src/flash_firmware.c ****     return flashStatus;
 177              		.loc 1 49 0
ARM GAS  /var/folders/k_/d4dbklhx7q1fs9lh20k9kt840000gn/T//ccA01qef.s 			page 5


 178 00d0 9DF85F00 		ldrb	r0, [sp, #95]	@ zero_extendqisi2
  50:Src/flash_firmware.c **** }
 179              		.loc 1 50 0
 180 00d4 19B0     		add	sp, sp, #100
 181              	.LCFI2:
 182              		.cfi_def_cfa_offset 20
 183              		@ sp needed
 184 00d6 F0BD     		pop	{r4, r5, r6, r7, pc}
 185              	.LVL14:
 186              	.L11:
 187              		.align	2
 188              	.L10:
 189 00d8 00000000 		.word	firstPackage
 190 00dc 0C000000 		.word	.LC1
 191 00e0 00000000 		.word	huart2
 192 00e4 00000000 		.word	.LC0
 193 00e8 00000000 		.word	flashAddress
 194 00ec 18000000 		.word	.LC2
 195 00f0 1C000000 		.word	.LC3
 196              		.cfi_endproc
 197              	.LFE133:
 199              		.section	.rodata.Save_Rec_FW.str1.4,"aMS",%progbits,1
 200              		.align	2
 201              	.LC0:
 202 0000 45726173 		.ascii	"Erased\015\012\000"
 202      65640D0A 
 202      00
 203 0009 000000   		.space	3
 204              	.LC1:
 205 000c 466C6173 		.ascii	"Flashing\015\012\000"
 205      68696E67 
 205      0D0A00
 206 0017 00       		.space	1
 207              	.LC2:
 208 0018 2000     		.ascii	" \000"
 209 001a 0000     		.space	2
 210              	.LC3:
 211 001c 0A00     		.ascii	"\012\000"
 212              		.text
 213              	.Letext0:
 214              		.file 2 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/machine/_default_types
 215              		.file 3 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/sys/lock.h"
 216              		.file 4 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/sys/_types.h"
 217              		.file 5 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h
 218              		.file 6 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/sys/reent.h"
 219              		.file 7 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/sys/_stdint.h"
 220              		.file 8 "Drivers/CMSIS/Include/core_cm4.h"
 221              		.file 9 "Drivers/CMSIS/Device/ST/STM32L4xx/Include/system_stm32l4xx.h"
 222              		.file 10 "Drivers/CMSIS/Device/ST/STM32L4xx/Include/stm32l476xx.h"
 223              		.file 11 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_def.h"
 224              		.file 12 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_dma.h"
 225              		.file 13 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_flash.h"
 226              		.file 14 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_uart.h"
 227              		.file 15 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal.h"
 228              		.file 16 "Inc/main.h"
 229              		.file 17 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/stdlib.h"
 230              		.file 18 "Middlewares/ST/STM32_USB_Device_Library/Core/Inc/usbd_def.h"
ARM GAS  /var/folders/k_/d4dbklhx7q1fs9lh20k9kt840000gn/T//ccA01qef.s 			page 6


 231              		.file 19 "Middlewares/ST/STM32_USB_Device_Library/Class/CDC/Inc/usbd_cdc.h"
 232              		.file 20 "Inc/usbd_cdc_if.h"
 233              		.file 21 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_flash_ex.h"
ARM GAS  /var/folders/k_/d4dbklhx7q1fs9lh20k9kt840000gn/T//ccA01qef.s 			page 7


DEFINED SYMBOLS
                            *ABS*:0000000000000000 flash_firmware.c
/var/folders/k_/d4dbklhx7q1fs9lh20k9kt840000gn/T//ccA01qef.s:18     .text.Save_Rec_FW:0000000000000000 $t
/var/folders/k_/d4dbklhx7q1fs9lh20k9kt840000gn/T//ccA01qef.s:25     .text.Save_Rec_FW:0000000000000000 Save_Rec_FW
/var/folders/k_/d4dbklhx7q1fs9lh20k9kt840000gn/T//ccA01qef.s:189    .text.Save_Rec_FW:00000000000000d8 $d
/var/folders/k_/d4dbklhx7q1fs9lh20k9kt840000gn/T//ccA01qef.s:200    .rodata.Save_Rec_FW.str1.4:0000000000000000 $d

UNDEFINED SYMBOLS
HAL_FLASH_Unlock
HAL_UART_Transmit
HAL_FLASHEx_Erase
HAL_FLASH_Program
HAL_FLASH_Lock
firstPackage
huart2
flashAddress
